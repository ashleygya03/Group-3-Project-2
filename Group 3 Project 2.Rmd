---
title: "Analyzing The Leading Causes of Death in the USA"
author: Ashley Gyapomah, Omissy, Mayur
output:
  html_document:
    code_folding: hide
    number_sections: true
    toc: true
    toc_depth: 3
    toc_float: yes
date: "2025-04-15"
---

```{r init, include=F}
# The package "ezids" (EZ Intro to Data Science) includes a lot of the helper functions we developed for the course. 
# Some of the frequently used functions are loadPkg(), xkabledply(), xkablesummary(), uzscale(), etc.
library(dplyr)
library(ggplot2)
library(pROC)
library(rpart)
library(rpart.plot)
library(knitr)
```



```{r setup, include=FALSE}
# some of common options (and the defaults) are: 
# include=T, eval=T, echo=T, results='hide'/'asis'/'markup',..., collapse=F, warning=T, message=T, error=T, cache=T, fig.width=6, fig.height=4, fig.dim=c(6,4) #inches, fig.align='left'/'center','right', 
knitr::opts_chunk$set(warning = F, results = "markup", message = F)
# knitr::opts_chunk$set(warning = F, results = "hide", message = F)
options(scientific=T, digits = 3) 
# options(scipen=9, digits = 3) 
# ‘scipen’: integer. A penalty to be applied when deciding to print numeric values in fixed or exponential notation.  Positive values bias towards fixed and negative towards scientific notation: fixed notation will be preferred unless it is more than ‘scipen’ digits wider.
# use scipen=999 to prevent scientific notation at all times

```

``` {r}
death_data <- read.csv("causes-of-death.csv", stringsAsFactors = FALSE)
death_data <- death_data[death_data$`Cause.Name` != "All causes", ]
death_data<- death_data[, !names(death_data) %in% c("X113.Cause.Name")]

colnames(death_data) <- c("Year", "Cause", "State", "Deaths", "Death_Rate")

death_data$Year <- as.numeric(death_data$Year)
death_data$State <- as.factor(death_data$State)
death_data$Cause <- as.factor(death_data$Cause)
death_data$Death_Rate <- as.numeric(death_data$Death_Rate)

str(death_data)
colSums(is.na(death_data))

summary(death_data)
```

# **Abstract**

This project explores the leading causes of death in the United States from 1999 to 2017 using age-adjusted mortality data collected from national death certificates. The goal was to investigate how mortality patterns have changed over time, varied by state, and evolved among major causes such as heart disease, cancer, unintentional injuries, and suicide. Using exploratory data analysis and statistical testing, we addressed three SMART research questions focused on temporal trends, regional disparities, and cause-specific mortality shifts.
Our findings show a national decline in mortality rates from 1999 to 2010, followed by a modest increase, potentially linked to the rise of the opioid epidemic and behavioral health crises. Geographic analysis revealed significant differences in mortality between states, with the South consistently reporting higher death rates than states like California or Hawaii. Trend analysis across causes revealed a decline in heart disease and cancer, alongside rising rates of unintentional injuries and suicide, particularly after 2010.
The analysis provides meaningful insight into public health progress and challenges over nearly two decades. While the dataset offered rich national and state-level detail, limitations such as missing demographic variables suggest future research should explore disparities by age, race, and socioeconomic status. Our conclusions underscore the importance of data-driven public health strategies that address both chronic and emerging causes of death through targeted prevention and policy interventions.


# Introduction

In a world of public health, observing mortality rates and trends will always present itself as a source of important information. Understanding mortality trends is essential for public health planning, policy-making, and medical advancements. Analyzing the leading causes of death in the United States from 1999 to 2017 provides valuable insights into long-term health patterns, disparities between states, and the effectiveness of public health interventions. 

As time goes on, the mortality rates increase, as well as the age rate for how long people live and, therefore, die from natural causes. Mortality rates fluctuate due to a combination of medical advancements, policy changes, socio-economic factors, and public health initiatives. For instance, cancer mortality has declined due to improvements in early detection and treatment, while opioid-related death hs have surged due to the opioid epidemic in the 2010s. Similarly, heart disease remains the leading cause of death, but states with strong preventive health policies show lower mortality rates. These are just a few of the notable trends observed in the U.S. With our dataset, we aim to explore these patterns further and uncover additional insights.

By analyzing this dataset, our goal is to identify the following:   


## SMART Research Questions
1. **Can we predict death rates from major causes based on location and time using linear regression and regression trees?**
2. **Which factors, including time and geography, are most associated with higher mortality rates from heart disease across different states?**



# Exploratory Data Analysis (EDA)

## Overall Death Rate Trends Over Time 

```{r}
ggplot(death_data, aes(x = Year, y = Death_Rate)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm") +
  labs(title = "Death Rates Over Time", x = "Year", y = "Death Rate")
```

The scatterplot of death rates over time reveals a general decline in age-adjusted mortality rates in the United States from 1999 to 2017. A fitted linear trendline confirms this downward movement, suggesting steady improvements in public health and healthcare access. Variability among states and causes was higher at the beginning of the period but appears to decrease over time, indicating a possible convergence in mortality outcomes across different regions and disease types. The reduction in extremely high death rates over time highlights the success of targeted health interventions for high-risk causes.


## Death Rates by State 

```{r}
ggplot(death_data, aes(x = State, y = Death_Rate)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90)) +
  labs(title = "Death Rates by State", x = "State", y = "Death Rate")
```

The boxplot of death rates by state reveals marked geographic disparities in mortality rates across the United States. Southern states, including Mississippi, Alabama, and West Virginia, exhibit consistently higher median death rates, while states in the Northeast and West, such as New York and California, show lower death rates. Significant variability within states highlights the differing impacts of leading causes of death. The presence of outliers suggests that certain causes contribute disproportionately to mortality in some regions. These findings emphasize the need for region-specific public health interventions to address the underlying drivers of excess mortality.

## Death Rates by Cause 

```{r}
ggplot(death_data, aes(x = Cause, y = Death_Rate)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90)) +
  labs(title = "Death Rates by Cause", x = "Cause", y = "Death Rate")
```

The distribution of death rates by cause reveals that heart disease and cancer are the predominant contributors to mortality in the United States. Both causes demonstrate substantially higher median death rates compared to other leading causes. Heart disease, in particular, exhibits wide variability, suggesting regional or temporal disparities in cardiovascular health outcomes. In contrast, causes such as suicide, kidney disease, and influenza/pneumonia present much lower death rates. The presence of outliers across several causes indicates that localized spikes in mortality may occur due to environmental or social factors. These findings highlight the disproportionate impact of heart disease and cancer on overall mortality trends.




## Correlations Between Numeric Variables 

```{r}
library(corrplot)
death_data_num <- death_data %>% select_if(is.numeric)
corrplot(cor(death_data_num, use="complete.obs"), method="circle")

```

The correlation matrix reveals a weak negative association between year and age-adjusted death rate, indicating a general decline in mortality over time. There is **a moderate positive correlation** between raw death counts and death rates, suggesting that areas with more deaths tend to exhibit higher age-adjusted mortality as well. Interestingly, the number of deaths shows little correlation with time, implying that while raw death counts have remained relatively stable, the burden of disease has shifted in terms of rates and potentially cause distribution. These correlations support our decision to use Year, State, and Cause as predictors in subsequent modeling.



# Model Building

## Linear Regression Model (GLM)

```{r}
death_data$Death_Rate <- as.numeric(as.character(death_data$Death_Rate))
model_linear <- lm(Death_Rate ~ Year + State, data = death_data)
summary(model_linear)

```

Interpretation: While the model confirms a national decline in death rates over time, and reveals statistically significant geographic differences, it does not explain much of the variation in death rates overall. The low R-squared values suggest that additional variables—such as cause of death, socioeconomic conditions, healthcare access, and demographics—are needed to more fully explain patterns in U.S. mortality. These results establish a strong foundation for future modeling that incorporates these additional predictors.



# Model Diagnostic 

```{r}
plot(model_linear, which = 1)  # Residuals vs Fitted
plot(model_linear, which = 2)  # Normal Q-Q Plot

summary(model_linear)$r.squared
summary(model_linear)$adj.r.squared

```
Interpretation: To assess the performance and assumptions of the linear regression model predicting age-adjusted death rates from year and state, we examined diagnostic plots and model fit statistics.

The residuals vs. fitted plot reveals a clear violation of the linear regression assumption of homoscedasticity (constant variance). Instead of a random scatter around zero, the residuals fan out in a funnel shape, indicating heteroscedasticity. This suggests that the variance in death rates increases as the predicted values rise, which could reduce the reliability of standard error estimates and p-values.


# Regression Tree Modeling 

## Building a Regression Tree

```{r}
tree_model <- rpart(Death_Rate ~ Year + State + Cause, data = death_data, method = "anova")
rpart.plot(tree_model)
summary(tree_model)
```

Interpretation: The regression tree model demonstrated that cause of death is the most important factor in predicting age-adjusted death rates, accounting for nearly all the model’s predictive power. The tree’s first and most impactful split separated high-mortality causes like heart disease and cancer from lower-mortality causes such as Alzheimer’s, diabetes, and pneumonia. Additional splits by year further refined the model, indicating that mortality rates have declined in more recent years. While state was considered, it did not emerge as a primary factor. Overall, the regression tree provided clear, interpretable groupings and outperformed the linear model in capturing non-linear patterns in the data.

# **Smart Question 1**

# **Smart Question 2**
## Can we predict deaths of specific causes ( heart disease, cancer, accidents) based on location and time using linear regression and regression trees?


# **Model Selection & Results**
Linear Regression (Inference)
1. Heart Disease: Year coefficient of −5.4 deaths/100k/year (p < 0.001); R² = 0.93

2. Cancer: Similar declining trend; R² = 0.96

3. Unintentional Injuries: More variability; R² = 0.81

4. All-Cause Mortality: R² = 0.015, indicating poor fit

Diagnostic plots confirm model assumptions for specific causes but not for all-cause mortality.

Regression Trees (Prediction)
1. Heart Disease: R² = 0.86

2. Unintentional Injuries: R² = 0.76

Regression trees provide interpretable decision rules aiding in public health forecasting.

# **Interpretation & Limitations**
High R² for Specific Causes
1. Consistency: Strong, stable temporal trends and geographic patterns.
2. Public Health Efforts: Reflects effectiveness of interventions like statin use and smoking bans.

Low R² for All-Cause Mortality
1. Heterogeneity: Combining diverse causes dilutes specific patterns.
2. Missing Variables: Lack of socioeconomic and behavioral data limits explanatory power.

Model Reliability
1. Specific Causes: High R² indicates robust trends but does not imply causation.
2. All-Cause Mortality: Low R² signals need for richer data.

# **Discussion & Insights**

We developed a multiple linear regression model to examine how age-adjusted death rates across the United States varied by year and state. The model identified a statistically significant downward trend over time, with each passing year associated with an average decrease of approximately 0.92 deaths per 100,000 population. This supports earlier visual analyses suggesting a gradual national decline in mortality from 1999 to 2017, likely reflecting advances in healthcare access, preventive strategies, and chronic disease management.

Geographic differences also appeared relevant. Several states—such as Hawaii, Minnesota, Utah, and Connecticut—had significantly lower death rates than the reference state (likely Alabama). For example, Hawaii’s coefficient of –25.71 indicates that, on average, it experienced 25 fewer deaths per 100,000 than the reference state, even after accounting for time. However, not all state-level differences were statistically significant; states like Mississippi and West Virginia, despite slightly higher average rates, did not differ meaningfully in this model.

Although the model was statistically significant (p < 0.001), its explanatory power was limited. The R-squared value was just 0.0153, with an adjusted R-squared of 0.0101, meaning the model explained only about 1–1.5% of the variation in death rates. This suggests that while time and geography play a role, they alone are insufficient to capture the complexity of mortality trends across the U.S.

To complement this approach, we implemented a regression tree using year, state, and cause of death as predictors. This model, built using recursive partitioning, identified subgroups with distinct mortality patterns and allowed for the capture of non-linear relationships and interactions between variables. The results confirmed that cause of death was the most influential predictor, accounting for 98% of the model’s variable importance. The tree’s initial split separated causes into two broad groups: one consisting of lower-mortality conditions such as Alzheimer’s, diabetes, pneumonia, and kidney disease, and another composed primarily of higher-mortality causes like heart disease and cancer. The difference in average death rates between these groups was substantial, highlighting the central role of disease type in driving mortality.

Additional splits showed that year contributed modestly to model performance. Among the high-mortality causes, average death rates were higher in earlier years (mean ≈ 214) and declined after 2006 (mean ≈ 173). Within the lower-mortality group, the model also distinguished between extremely low-risk and moderate-risk causes. Interestingly, state did not emerge as a primary factor in the regression tree, reinforcing the earlier conclusion that geography has a relatively minor role compared to cause of death and time.

The regression tree provided a more nuanced view of mortality patterns than the linear model. It effectively captured complex, non-linear relationships and emphasized that cause of death is by far the strongest determinant of mortality rates, followed by time. The model’s structure suggests that incorporating additional categorical and interaction effects may improve predictive accuracy even further.

Finally, diagnostic plots for the linear regression model revealed that key assumptions were violated. The residuals vs. fitted plot showed increasing variance across fitted values, indicating heteroscedasticity. The Q-Q plot displayed notable departures from normality, with heavy tails and skewness, suggesting the presence of influential observations and non-normal residuals. These issues, combined with the model’s low R-squared values, reinforce that the linear model does not adequately explain variation in death rates and would benefit from the inclusion of additional variables such as demographic factors, healthcare access, or behavioral health indicators.

# **Recommendations**
Targeted Interventions: Prioritize Southern states for heart disease prevention (e.g., subsidized screenings in MS).

Data Enrichment: Integrate county-level income, education, and opioid prescription data.

Policy Evaluation: Use difference-in-differences to assess Medicaid expansion’s impact.

# **References**
Centers for Disease Control and Prevention. (2024, November 1). Understanding the opioid overdose  epidemic. Centers for Disease Control and Prevention. https://www.cdc.gov/overdose-prevention/about/understanding-the-opioid-overdose-epidemic.html 

Kaggle. (n.d.). Leading causes of death (1999-2017) [Data set]. Kaggle. https://www.kaggle.com/datasets/kj9986/leading-causes-of-death
